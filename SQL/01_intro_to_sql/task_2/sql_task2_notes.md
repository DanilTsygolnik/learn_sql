## Конспект

### Базовые понятия

**База данных** - это совокупность данных, организованных определенным образом и связанных друг с другом. Способ организации и связывания данных называют **моделью БД**.

Здесь используется именно понятие "данные", а не "информация", т.к. в общем случае содержимое БД может не нести никакого смысла. В частности, представление данных в удобном для человеческого восприятия виде возможно благодаря СУБД.

**СУБД** - программная среда, позволяющая манипулировать данными, содержащимися в БД.

В качестве наглядной абстракции, БД можно представить в виде системы связанных таблиц.

**Таблица данных** - это набор записей фиксированной структуры (строки и столбцы), каждая из которых описывает определенный информационный объект БД.

### Реляционные БД

**Реляционная модель БД** - это модель БД, состоящая из таблиц и связей, описанная выше.

Реляционная модель определяется [12 правилами Эдгара Ф. Кодда](https://ru.wikipedia.org/wiki/12_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB_%D0%9A%D0%BE%D0%B4%D0%B4%D0%B0).

**Нормализация БД** - это формальная технология приведение БД к т.н. нормальной схеме.
 Почему это называется "технологией"??
 Для чего нужна нормализация? - Добиться непротиворечивости хранимых данных, связанных между собой, и избежать их дублирования.

**Нормальная схема БД** - совокупность требований к организации взаимосвязанных таблиц в для обеспечения минимальной избыточности хранимых в БД данных.

Есть несколько схем, каждая предполагает набор определенных требований:
- 1NF: исключить дублирование данных, выделить первичные ключи для записей данных (распределяем все по таблицам);
- 2NF: все без исключения вторичные значения в записях должны полностью зависеть от первичного ключа;
- 3NF: все вторичные ключи являются взаимно независимыми;

**Первичный ключ** - это элемент данных, уникальный для каждой записи и однозначно ее идентифицирующий.

---

Общая идея создания базы данных из набора таблиц подразумевает разделение (расщепление) таблиц таким образом, чтобы автономная в смысловом плане информация хранилась в отдельной таблице, обычно называемой справочником. Если, например, имеется набор данных по заказам, каждая запись которого содержит наборы полей по клиенту и по исполнителю, то, очевидно, большой объем сведений дублируется. Ведь сведения как об одном клиенте, так и об одном исполнителе могут многократно повторяться в разных комбинациях. Если потребуется модифицировать описание клиента, придется найти и откорректировать все записи, в которых он упомянут.

Для устранения избыточности следует создать два новых справочника: один по клиентам, другой по исполнителям. Описание заказов ведется в отдельной таблице. В нее помимо прямой информации о заказе (дата, сумма, товар) включаются первичные ключи (уникальные идентификаторы) соответствующих записей о клиенте и исполнителе. При этом любая модификация их описаний подразумевает внесение изменений лишь в один справочник -- таблица заказов останется неизменной. Когда же потребуется подробная информация о заказе, детальные сведения о клиенте и исполнителе будут динамически извлечены из соответствующих справочников на основании их ключей.

<img src="https://skillsmart.ru/data//sql0/sq1.png" alt="tables" height="300"/>

В системах, где каждая таблица насчитывает несколько десятков полей, вторая нормальная форма обеспечивает удовлетворительную производительность. Однако если объем информации велик, то внутри понятия, представленного схемой таблицы, обычно существуют дополнительные взаимосвязи. Если, например, полное имя клиента состоит из трех полей: Имя, Фамилия и Отчество, -- их можно, в свою очередь, вынести в отдельную таблицу. В исходной таблице вместо трех текстовых полей потребуется ввести одно, хранящее значение первичного ключа из таблицы с именами. При полном разделении таких вторичных полей получается третья нормальная форма. Этот процесс также во многом интуитивен и подразумевает выделение смысловых элементов во вторичных данных.

### Отношения между таблицами

Типы отношений:
- **один к одному**: это когда в одному значению из первой таблицы соответствует строго одно значение во второй;
- **один ко многим**: более распространенный случай, это когда одно значение из первой таблицы связано с несколькими значениями во второй;
- **многие со многими**: это когда в обеих таблицах содержатся связанные значения (связанные пары), каждый элемент такой пары, в свою очередь, связан с множеством элементов из других таблиц.

#### Об отношениях подробнее

Важная характеристика базы данных -- так называемая степень связи. Она определяет, в каком количественном отношении связи находятся две сущности. Например, каждый клиент может иметь только один заказ.

Тогда в таблицу клиентов достаточно добавить одно поле, хранящее первичный ключ записи в таблице заказов (такой ключ называется внешним). В таком случае отношения между двумя сущностями (таблицей клиента и таблицей заказа) называется отношением один-к-одному -- каждому значению одной таблицы соответствует ровно одно значение другой таблицы.

На практике гораздо чаще встречается отношение один-ко-многим. Например, один клиент может иметь много заказов, но каждый заказ сделан только одним клиентом. Тогда приходится создавать минимум две таблицы. Одна содержит описания заказов и включает поле для значения первичного ключа клиента (значения в этом поле могут повторяться), а вторая хранит описания клиентов.

Если подразумевается партнерство, в котором у клиента может быть несколько исполнителей его требований, а у исполнителя — несколько клиентов, придется создавать три таблицы. Две из них представляют собой справочники по клиентам и исполнителям, а третья хранит пары ключей "клиент -- исполнитель". При этом в ней допускается повторение значений в любом из столбцов. Такое соотношение называется многие-ко-многим.

<img src="https://skillsmart.ru/data//sql0/sq2.png" alt="relations_schema" width=600/>

Обычно первичный ключ обозначается PK (Primary Key), а внешний ключ -- FK (Foreign Key). Взаимосвязи между таблицами базы northwind можно выявить, заглянув в раздел Keys каждой таблицы. Там указаны как первичные ключи, начинающиеся с префикса PK_ , так и вторичные, начинающиеся с префикса FK_ . 

---

По части работы с СУБД, я узнал:
- как узнать, с какими таблицами связана данная (раздел Keys -- добавить скрины);
- в ходе анализа связей таблиц учебной БД Northwest (дз -- ссылку на файл) понял различие типов отношений;

# Практика

**Задание**: разобраться во взаимосвязях между таблицами БД Northwind и описать их (один-к-одному, один-ко-многим и многие-ко-многим).

![Файл с решением](sql_task2_prac.md)
