## Базовая работа с БД

### Создание базы данных

Создание БД требует соответствующих [привелегий](managing_roles.md#Управление-ролями-требования), поэтому универсальный вариант - работать из под системного пользователя _postgres_:
```
createdb -U postgres <database_name>
```

### Подключение к базе данных

Вывести список доступных БД:
- через терминал: `sudo -u postgres psql -l`
- из psql (PostgreSQL interactive terminal): `\l'`

Если создана [роль для пользователя текущей сессии](managing_roles.md#Роль-для-вызова-psql), сработают сокращенные команды:
```
# создаем и удаляем новую БД из под пользовательской роли
$ createdb <database_name>
$ dropdb <database_name>

# подключаемся к дефолтной БД пользовательской роли
$ psql

# выводим список доступных БД из под пользовательской роли
$ psql -l
$ psql -c '\l'

# подключаемся к БД customers из под пользовательской роли
$ psql customers
```

Работа через psql означает, что есть действующее подключение к некоторой БД. Несколько полезных команд интерактивной оболочки:
- вывести сведения о подключении: `\conninfo`;
- вывести данные об отношениях внутри БД (схема): `\d` (от describe);
- вывести данные о таблице: `\d tablename`;

### Добавление данных в базу

Задача данного раздела - показать, как можно добавлять данные в БД из командной строки, не вдаваясь при этом в подробности построения SQL-запросов (о них - в отдельном [цикле заметок](dml.md)).

_Пусть из командной строки требуется создать новую БД "hexlet", которая будет содержать 2 таблицы с данными: topics и users._

psql позволяет вводить и выполнять многострочные SQL-запросы, но это неудобно. Детали реализации запросов рассматриваются в других заметках, сейчас же важно другое.

Операции добавления данных в БД и можно записать в отдельные файлы:
1) схема данных ([schema.sql](hexlet_db/schema.sql));
2) набор данных для таблицы topics ([topics.sql](hexlet_db/topics.sql));
3) набор данных для таблицы users ([users.sql](hexlet_db/users.sql));

Остается поочередно выполнить следующие команды, находясь в директории с sql-файлами, и поставленная задача будет решена:
```
psql hexlet < schema.sql
psql hexlet < topics.sql
psql hexlet < users.sql
```
Команды выше можно объединить в одну: `make load-all`. Её нужно запустить (для данного [make-файла](hexlet_db/Makefile)), находясь в директории с sql-файлами.

С помощью аналогичного [make-файла](northwind_db/Makefile) создал БД [northwind](https://github.com/pthom/northwind_psql) для практики.
